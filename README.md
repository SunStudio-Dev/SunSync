# SunSync

Плагин для Paper Minecraft 1.21, который синхронизирует инвентарь, здоровье и другие параметры между всеми игроками на сервере.

## Особенности

### Основная синхронизация
- **Общий инвентарь**: содержимое инвентаря, броня и предметы в дополнительной руке
- **Синхронизация здоровья**: здоровье, уровень сытости, насыщение и истощение
- **Опыт и уровни**: синхронизация опыта и уровней игроков
- **Эндер-сундук**: общий доступ к содержимому эндер-сундука
- **Точки возрождения**: синхронизация точек спавна (кровати/якоря возрождения)
- **Эффекты зелий**: синхронизация активных эффектов зелий
- **Воздух под водой**: синхронизация уровня кислорода

### Система защиты игроков
- **Защищенные игроки**: возможность исключить определенных игроков из синхронизации
- **Умная логика**: корректная обработка входа/выхода защищенных игроков
- **Сохранение состояния**: автоматическое сохранение состояния при изменении защищенных игроков

### Статистика смертей
- **Отслеживание смертей**: подсчет смертей каждого игрока
- **Интеграция с PlaceholderAPI**: поддержка плейсхолдеров для других плагинов
- **Управление статистикой**: команды для просмотра и очистки статистики

### Блокировка контейнеров
- **Эксклюзивный доступ**: предотвращение одновременного использования контейнеров
- **Уведомления**: информирование игроков о занятых контейнерах
- **Автоматическое освобождение**: освобождение контейнеров при выходе игрока

## Команды

### Основные команды
- `/sunsync` - Показать краткий статус плагина
- `/sunsync help` - Показать справку по командам
- `/sunsync status` - Подробный статус плагина

### Управление синхронизацией
- `/sunsync on` - Включить синхронизацию
- `/sunsync off` - Выключить синхронизацию

### Управление защитой игроков
- `/sunsync protect on` - Включить систему защиты игроков
- `/sunsync protect off` - Выключить систему защиты игроков
- `/sunsync protect add <игрок>` - Добавить игрока в защищенные
- `/sunsync protect delete <игрок>` - Убрать игрока из защищенных
- `/sunsync protect list` - Показать список защищенных игроков

### Управление статистикой
- `/sunsync stats on` - Включить отслеживание смертей
- `/sunsync stats off` - Выключить отслеживание смертей
- `/sunsync stats show` - Показать топ смертей
- `/sunsync stats show <игрок>` - Показать статистику конкретного игрока
- `/sunsync stats clear all` - Очистить всю статистику смертей
- `/sunsync stats clear <игрок>` - Очистить статистику конкретного игрока

## Права доступа

- `sunsync.admin` - Доступ ко всем командам плагина (по умолчанию только для операторов)

## PlaceholderAPI

При установленном PlaceholderAPI доступны следующие плейсхолдеры:
- `%sunsync_deaths%` - Количество смертей текущего игрока

## Сборка проекта

1. Убедитесь, что у вас установлены Maven и JDK 17+
2. Перейдите в директорию SunSync в терминале
3. Выполните команду `mvn clean package`
4. Собранный JAR-файл будет находиться в `target/sunsync-1.0-SNAPSHOT.jar`

## Установка

1. Скопируйте JAR-файл в папку `plugins` вашего Paper сервера
2. Перезапустите сервер
3. Плагин автоматически создаст необходимые конфигурационные файлы

## Конфигурационные файлы

Плагин создает следующие файлы в папке `plugins/SunSync/`:

- `settings.yml` - Основные настройки плагина
- `shared_state.yml` - Сохраненное состояние для синхронизации
- `deaths.yml` - Статистика смертей игроков

## Техническая информация

### Принцип работы
- Синхронизация происходит каждый тик (20 раз в секунду)
- Изменения отслеживаются через хеширование состояния игроков
- Синхронизация происходит от случайного незащищенного игрока

### Умная система смертей
- При смерти одного игрока все остальные незащищенные игроки также умирают
- Сохраняется оригинальная причина смерти для корректной анимации
- Предотвращается дублирование дропа предметов

### Система файлов состояния
- Автоматическое сохранение состояния при выходе последнего незащищенного игрока
- Загрузка состояния при входе первого незащищенного игрока
- Корректная обработка защищенных игроков при включении/выключении защиты

## Примечания

- Синхронизация работает только между незащищенными игроками
- Защищенные игроки полностью исключены из процесса синхронизации
- При отключении синхронизации текущее состояние сохраняется в файл
- Плагин совместим с PlaceholderAPI для интеграции с другими плагинами

## Поддержка

Если у вас возникли проблемы:
1. Проверьте консоль сервера на наличие ошибок
2. Убедитесь, что используется Paper 1.21+
3. Проверьте права доступа к командам 